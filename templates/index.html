<!DOCTYPE html>
<html>
  <head>
    <title>Image Auto-Tagging System</title>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css"
    />
    <style>
      .tag {
        display: inline-block;
        background-color: #3498db;
        color: white;
        border-radius: 20px;
        padding: 5px 12px;
        margin: 5px;
        font-size: 14px;
        font-weight: 500;
        transition: transform 0.2s;
      }
      .tag:hover {
        transform: scale(1.05);
        background-color: #2980b9;
      }
      .upload-area {
        border: 2px dashed #ccc;
        border-radius: 8px;
        padding: 40px;
        text-align: center;
        cursor: pointer;
        transition: all 0.3s;
        background-color: #f8f9fa;
      }
      .upload-area:hover {
        border-color: #3498db;
        background-color: #f1f7fe;
      }
      .preview-image {
        max-width: 100%;
        max-height: 300px;
        margin-top: 20px;
        border-radius: 8px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      }
      .card {
        border-radius: 10px;
        box-shadow: 0 6px 10px rgba(0, 0, 0, 0.1);
        margin-bottom: 20px;
      }
      h1 {
        color: #2c3e50;
        font-weight: 700;
      }
      .loading {
        display: inline-block;
        width: 20px;
        height: 20px;
        border: 3px solid rgba(0, 0, 0, 0.1);
        border-radius: 50%;
        border-top-color: #3498db;
        animation: spin 1s ease-in-out infinite;
        margin-right: 10px;
      }
      @keyframes spin {
        to {
          transform: rotate(360deg);
        }
      }
    </style>
  </head>
  <body class="bg-light">
    <div class="container mt-5">
      <h1 class="mb-4 text-center">
        Content-Based Auto-Tagging of Flickr Images
      </h1>
      <p class="text-center text-muted mb-5">
        Upload an image to automatically generate relevant tags using our
        GNN-based system
      </p>

      <div class="row justify-content-center">
        <div class="col-md-10">
          <div class="card p-4">
            <div class="row">
              <div class="col-md-6">
                <h4 class="mb-3">Upload Image</h4>
                <div class="upload-area" id="uploadArea">
                  <i
                    class="fas fa-cloud-upload-alt mb-3"
                    style="font-size: 48px; color: #3498db"
                  ></i>
                  <p>Drag and drop an image here or click to upload</p>
                  <p class="text-muted small">
                    Supported formats: JPG, PNG, JPEG
                  </p>
                  <input type="file" id="fileInput" hidden accept="image/*" />
                </div>
              </div>

              <div class="col-md-6">
                <div id="results" class="d-none">
                  <h4 class="mb-3">Predicted Tags</h4>
                  <div id="tagContainer" class="mb-4">
                    <div class="loading"></div>
                    Analyzing image...
                  </div>
                  <h5 class="mb-2">Image Preview</h5>
                  <img id="previewImage" class="preview-image" />
                </div>
              </div>
            </div>
          </div>

          <div class="card p-4 mt-4">
            <h4>About This Project</h4>
            <p>This Content-Based Auto-Tagging system was developed by:</p>
            <ul>
              <li>Bratati Rout [M24DE3023]</li>
              <li>Sharone Verma [M24DE3072]</li>
              <li>Yash Engendala [M24DE3086]</li>
            </ul>
            <p>
              The system uses a Graph Neural Network (GNN) trained on the
              Flickr8k dataset to generate relevant tags for images based on
              their visual content.
            </p>
          </div>
        </div>
      </div>
    </div>

    <script
      src="https://kit.fontawesome.com/3a0c5f7ea0.js"
      crossorigin="anonymous"
    ></script>
    <script>
      document.getElementById("uploadArea").addEventListener("click", () => {
        document.getElementById("fileInput").click();
      });

      document
        .getElementById("fileInput")
        .addEventListener("change", handleFileUpload);

      function handleFileUpload(event) {
        const file = event.target.files[0];
        if (!file) return;

        const formData = new FormData();
        formData.append("file", file);

        // Show loading state
        document.getElementById("tagContainer").innerHTML =
          '<div class="loading"></div> Analyzing image...';
        document.getElementById("results").classList.remove("d-none");

        // Display preview
        const reader = new FileReader();
        reader.onload = function (e) {
          document.getElementById("previewImage").src = e.target.result;
        };
        reader.readAsDataURL(file);

        // Send to backend
        fetch("/upload", {
          method: "POST",
          body: formData,
        })
          .then((response) => response.json())
          .then((data) => {
            const tagContainer = document.getElementById("tagContainer");
            tagContainer.innerHTML = "";

            if (data.tags && data.tags.length > 0) {
              data.tags.forEach((tag) => {
                const tagSpan = document.createElement("span");
                tagSpan.className = "tag";
                tagSpan.textContent = tag;
                tagContainer.appendChild(tagSpan);
              });
            } else {
              tagContainer.textContent = "No tags found for this image";
            }
          })
          .catch((error) => {
            console.error("Error:", error);
            document.getElementById("tagContainer").innerHTML =
              "Error analyzing image";
          });
      }
    </script>
  </body>
</html>
